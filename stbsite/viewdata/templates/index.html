{% extends "base.html" %}

{% block style %}
<style>
table, th, td {
  border: 1px solid black;
}
</style>
{% endblock style %}

{% block script %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript">
var statusIntervalId = window.setInterval(checkStatus, 1000);
function checkStatus() {
    $.ajax({
        method: "GET",
        url: "/viewdata/check_status",
        data: {},
        success: function(data) {
            console.log(data)
            if (data.ftdi_connected == true) {
                $("#ftdi-status").css({ color: "green" }).text("online");
            } else {
                $("#ftdi-status").css({ color: "red" }).text("offline");
            }
            if (data.i2c_fanout_connected == true) {
                $("#i2c-fanout-status").css({ color: "green" }).text("online");
            } else {
                $("#i2c-fanout-status").css({ color: "red" }).text("offline");
            }
            if (data.adc_connected == 'ERROR') {
                $("#adc-status").css({ color: "red" }).text(data.adc_connected);
            } else {
                $("#adc-status").css({ color: "black" }).text(data.adc_connected);
            }
        }
    });
};
</script>
{% endblock script %}

{% block title %}
<title>Serenity Test Board</title>
{% endblock title %}

{% block body %}
<body>
    {% block nav-bar %}
    >> <a href="/viewdata/">Home</a>
    {% endblock nav-bar %}
    <h1>Serenity Test Card</h1>
    <h2>Tested Cards</h2>
    {% include "index_table.html" %}
    <h2>Status</h2>
    <div class="ftdi-status">
        <div style="float:left; padding-right:10px">
            FTDI status:
        </div>
        <div id="ftdi-status">
            waiting for status...
        </div>
    </div>
    <div class="i2c-fanout-status">
        <div style="float:left; padding-right:10px">
            I2C Fanout status:
        </div>
        <div id="i2c-fanout-status">
            waiting for status...
        </div>
    </div>
    <div class="adc-status">
        <div style="float:left; padding-right:10px">
            ADC test reading:
        </div>
        <div id="adc-status">
            no reading.
        </div>
    </div>
</body>
{% endblock body %}
